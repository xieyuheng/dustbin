;;; Input

(define (Y f)
  ((lambda (u) (u u))
   (lambda (x) (f (lambda (t) ((x x) t))))))

;;; ShrinkPass

(define (Y f)
  ((lambda (u) (u u))
   (lambda (x) (f (lambda (t) ((x x) t))))))

;;; UniquifyPass

(define (Y f)
  ((lambda (u₁) (u₁ u₁))
   (lambda (x₁) (f (lambda (t₁) ((x₁ x₁) t₁))))))

;;; RevealGlobalPass

(define (Y f)
  ((lambda (u₁) (u₁ u₁))
   (lambda (x₁) (f (lambda (t₁) ((x₁ x₁) t₁))))))

;;; LiftLambdaPass

(define (Y f)
  (((((@primitive-function make-curry 3) (@function Y©λ₁ 1))
     1)
    0)
   ((((@primitive-function curry-put! 3) 0) f)
    ((((@primitive-function make-curry 3) (@function Y©λ₂ 2))
      2)
     1))))

(define (Y©λ₁ u₁) (u₁ u₁))

(define (Y©λ₂ f x₁)
  (f ((((@primitive-function curry-put! 3) 0) x₁)
      ((((@primitive-function make-curry 3)
         (@function Y©λ₂©λ₁ 2))
        2)
       1))))

(define (Y©λ₂©λ₁ x₁ t₁) ((x₁ x₁) t₁))

;;; UnnestOperandPass

(define (Y f)
  (@let1 _₁ (@primitive-function make-curry 3)
    (@let1 _₂ (@function Y©λ₁ 1)
      (@let1 _₃ (_₁ _₂)
        (@let1 _₄ 1
          (@let1 _₅ (_₃ _₄)
            (@let1 _₆ 0
              (@let1 _₇ (_₅ _₆)
                (@let1 _₈ (@primitive-function curry-put! 3)
                  (@let1 _₉ 0
                    (@let1 _₁₀ (_₈ _₉)
                      (@let1 _₁₁ (_₁₀ f)
                        (@let1 _₁₂
                            (@primitive-function
                             make-curry
                             3)
                          (@let1 _₁₃ (@function Y©λ₂ 2)
                            (@let1 _₁₄ (_₁₂ _₁₃)
                              (@let1 _₁₅ 2
                                (@let1 _₁₆ (_₁₄ _₁₅)
                                  (@let1 _₁₇ 1
                                    (@let1 _₁₈ (_₁₆ _₁₇)
                                      (@let1 _₁₉ (_₁₁ _₁₈)
                                        (_₇ _₁₉)))))))))))))))))))))

(define (Y©λ₁ u₁) (u₁ u₁))

(define (Y©λ₂ f x₁)
  (@let1 _₁ (@primitive-function curry-put! 3)
    (@let1 _₂ 0
      (@let1 _₃ (_₁ _₂)
        (@let1 _₄ (_₃ x₁)
          (@let1 _₅ (@primitive-function make-curry 3)
            (@let1 _₆ (@function Y©λ₂©λ₁ 2)
              (@let1 _₇ (_₅ _₆)
                (@let1 _₈ 2
                  (@let1 _₉ (_₇ _₈)
                    (@let1 _₁₀ 1
                      (@let1 _₁₁ (_₉ _₁₀)
                        (@let1 _₁₂ (_₄ _₁₁) (f _₁₂))))))))))))))

(define (Y©λ₂©λ₁ x₁ t₁) (@let1 _₁ (x₁ x₁) (_₁ t₁)))

