(export _setup _main)

(define-space one 8)

(define-space one©flag 8)

(define-code one©flag-setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 16) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (external-label x-false)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (reg-deref (reg rbp) -8) (reg rax))
    (movq (reg rax) (label-deref (label one©flag)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 16) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code one©get
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (label one©flag)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (label-deref (external-label x-true)) (reg rax))
    (cmpq (reg-deref (reg rbp) -8) (reg rax))
    (branch-if (cc e) (label cached) (label init)))
  (block cached
    (movq (label-deref (label one)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (jmp (label epilog)))
  (block init
    (callq-n (label one©init-function) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (movq (reg rax) (label-deref (label one)))
    (movq (label-deref (external-label x-true)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (movq (reg rax) (label-deref (label one©flag)))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code one©init-function
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 16) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (imm 8) (reg-deref (reg rbp) -8))
    (movq (reg-deref (reg rbp) -8) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 16) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-space two 8)

(define-space two©flag 8)

(define-code two©flag-setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 16) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (external-label x-false)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (reg-deref (reg rbp) -8) (reg rax))
    (movq (reg rax) (label-deref (label two©flag)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 16) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code two©get
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (label two©flag)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (label-deref (external-label x-true)) (reg rax))
    (cmpq (reg-deref (reg rbp) -8) (reg rax))
    (branch-if (cc e) (label cached) (label init)))
  (block cached
    (movq (label-deref (label two)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (jmp (label epilog)))
  (block init
    (callq-n (label two©init-function) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (movq (reg rax) (label-deref (label two)))
    (movq (label-deref (external-label x-true)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (movq (reg rax) (label-deref (label two©flag)))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code two©init-function
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 48) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (label iadd©constant)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (imm 8) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -8) (reg rdi))
    (movq (reg-deref (reg rbp) -16) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (callq-n (label one©get) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -32))
    (movq (reg-deref (reg rbp) -24) (reg rdi))
    (movq (reg-deref (reg rbp) -32) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -40))
    (movq (reg-deref (reg rbp) -40) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 48) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-space three 8)

(define-space three©flag 8)

(define-code three©flag-setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 16) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (external-label x-false)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (reg-deref (reg rbp) -8) (reg rax))
    (movq (reg rax) (label-deref (label three©flag)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 16) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code three©get
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (label three©flag)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (label-deref (external-label x-true)) (reg rax))
    (cmpq (reg-deref (reg rbp) -8) (reg rax))
    (branch-if (cc e) (label cached) (label init)))
  (block cached
    (movq (label-deref (label three)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (jmp (label epilog)))
  (block init
    (callq-n (label three©init-function) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (movq (reg rax) (label-deref (label three)))
    (movq (label-deref (external-label x-true)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (movq (reg rax) (label-deref (label three©flag)))
    (movq (reg-deref (reg rbp) -16) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code three©init-function
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 48) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-deref (label iadd©constant)) (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (movq (imm 8) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -8) (reg rdi))
    (movq (reg-deref (reg rbp) -16) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (callq-n (label two©get) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -32))
    (movq (reg-deref (reg rbp) -24) (reg rdi))
    (movq (reg-deref (reg rbp) -32) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -40))
    (movq (reg-deref (reg rbp) -40) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 48) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-code _main
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq
     (label-deref (label println-non-void©constant))
     (reg rax))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (callq-n (label three©get) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -8) (reg rdi))
    (movq (reg-deref (reg rbp) -16) (reg rsi))
    (callq-n (external-label x-apply-unary) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-data _main©metadata
  (pointer _main©metadata/name)
  (int 0)
  (int 0)
  (pointer _main©variable-info)
  (pointer _main)
  (pointer _main/end))

(define-data _main©metadata/name (string "_main"))

(define-space _main©constant 8)

(define-code _main©setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq (label-imm (label _main)) (reg-deref (reg rbp) -8))
    (orq (imm 3) (reg-deref (reg rbp) -8))
    (movq
     (label-imm (label _main©metadata))
     (reg-deref (reg rbp) -16))
    (orq (imm 3) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -8) (reg rdi))
    (movq (reg-deref (reg rbp) -16) (reg rsi))
    (callq-n (external-label x-make-function) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (movq (reg rax) (label-deref (label _main©constant)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-data println-non-void©metadata
  (pointer println-non-void©metadata/name)
  (int 1)
  (int 1)
  (int 0)
  (int 0)
  (int 0))

(define-data println-non-void©metadata/name
  (string "println-non-void"))

(define-space println-non-void©constant 8)

(define-code println-non-void©setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq
     (label-imm (external-label x-println-non-void))
     (reg-deref (reg rbp) -8))
    (orq (imm 3) (reg-deref (reg rbp) -8))
    (movq
     (label-imm (label println-non-void©metadata))
     (reg-deref (reg rbp) -16))
    (orq (imm 3) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -8) (reg rdi))
    (movq (reg-deref (reg rbp) -16) (reg rsi))
    (callq-n (external-label x-make-function) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (movq
     (reg rax)
     (label-deref (label println-non-void©constant)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-data iadd©metadata
  (pointer iadd©metadata/name)
  (int 2)
  (int 1)
  (int 0)
  (int 0)
  (int 0))

(define-data iadd©metadata/name (string "iadd"))

(define-space iadd©constant 8)

(define-code iadd©setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq
     (label-imm (external-label x-iadd))
     (reg-deref (reg rbp) -8))
    (orq (imm 3) (reg-deref (reg rbp) -8))
    (movq
     (label-imm (label iadd©metadata))
     (reg-deref (reg rbp) -16))
    (orq (imm 3) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -8) (reg rdi))
    (movq (reg-deref (reg rbp) -16) (reg rsi))
    (callq-n (external-label x-make-function) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (movq (reg rax) (label-deref (label iadd©constant)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-data make-function©metadata
  (pointer make-function©metadata/name)
  (int 2)
  (int 1)
  (int 0)
  (int 0)
  (int 0))

(define-data make-function©metadata/name
  (string "make-function"))

(define-space make-function©constant 8)

(define-code make-function©setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 32) (reg rsp))
    (jmp (label body)))
  (block body
    (movq
     (label-imm (external-label x-make-function))
     (reg-deref (reg rbp) -8))
    (orq (imm 3) (reg-deref (reg rbp) -8))
    (movq
     (label-imm (label make-function©metadata))
     (reg-deref (reg rbp) -16))
    (orq (imm 3) (reg-deref (reg rbp) -16))
    (movq (reg-deref (reg rbp) -8) (reg rdi))
    (movq (reg-deref (reg rbp) -16) (reg rsi))
    (callq-n (external-label x-make-function) (arity 2))
    (movq (reg rax) (reg-deref (reg rbp) -24))
    (movq (reg-deref (reg rbp) -24) (reg rax))
    (movq
     (reg rax)
     (label-deref (label make-function©constant)))
    (jmp (label epilog)))
  (block epilog
    (addq (imm 32) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-data _function_table
  (int 0)
  (pointer _function_table/entries))

(define-data _function_table/entries)

(define-code _setup
  (block prolog
    (pushq (reg rbp))
    (movq (reg rsp) (reg rbp))
    (subq (imm 16) (reg rsp))
    (jmp (label body)))
  (block body
    (callq-n (label one©flag-setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (callq-n (label two©flag-setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (callq-n (label three©flag-setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (callq-n (label _main©setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (callq-n (label println-non-void©setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (callq-n (label iadd©setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -8))
    (callq-n (label make-function©setup) (arity 0))
    (movq (reg rax) (reg-deref (reg rbp) -8)))
  (block epilog
    (addq (imm 16) (reg rsp))
    (popq (reg rbp))
    (retq)))

(define-data one©flag-setup©variable-info
  (int 1)
  (pointer one©flag-setup©variable-info/names))

(define-data one©flag-setup©variable-info/names
  (pointer one©flag-setup©variable-info/names/0))

(define-data one©flag-setup©variable-info/names/0
  (string "false"))

(define-data one©get©variable-info
  (int 3)
  (pointer one©get©variable-info/names))

(define-data one©get©variable-info/names
  (pointer one©get©variable-info/names/0)
  (pointer one©get©variable-info/names/1)
  (pointer one©get©variable-info/names/2))

(define-data one©get©variable-info/names/0 (string "flag"))

(define-data one©get©variable-info/names/1
  (string "result"))

(define-data one©get©variable-info/names/2 (string "true"))

(define-data one©init-function©variable-info
  (int 1)
  (pointer one©init-function©variable-info/names))

(define-data one©init-function©variable-info/names
  (pointer one©init-function©variable-info/names/0))

(define-data one©init-function©variable-info/names/0
  (string "_↩"))

(define-data two©flag-setup©variable-info
  (int 1)
  (pointer two©flag-setup©variable-info/names))

(define-data two©flag-setup©variable-info/names
  (pointer two©flag-setup©variable-info/names/0))

(define-data two©flag-setup©variable-info/names/0
  (string "false"))

(define-data two©get©variable-info
  (int 3)
  (pointer two©get©variable-info/names))

(define-data two©get©variable-info/names
  (pointer two©get©variable-info/names/0)
  (pointer two©get©variable-info/names/1)
  (pointer two©get©variable-info/names/2))

(define-data two©get©variable-info/names/0 (string "flag"))

(define-data two©get©variable-info/names/1
  (string "result"))

(define-data two©get©variable-info/names/2 (string "true"))

(define-data two©init-function©variable-info
  (int 5)
  (pointer two©init-function©variable-info/names))

(define-data two©init-function©variable-info/names
  (pointer two©init-function©variable-info/names/0)
  (pointer two©init-function©variable-info/names/1)
  (pointer two©init-function©variable-info/names/2)
  (pointer two©init-function©variable-info/names/3)
  (pointer two©init-function©variable-info/names/4))

(define-data two©init-function©variable-info/names/0
  (string "_₁"))

(define-data two©init-function©variable-info/names/1
  (string "_₂"))

(define-data two©init-function©variable-info/names/2
  (string "_₃"))

(define-data two©init-function©variable-info/names/3
  (string "_₄"))

(define-data two©init-function©variable-info/names/4
  (string "_↩"))

(define-data three©flag-setup©variable-info
  (int 1)
  (pointer three©flag-setup©variable-info/names))

(define-data three©flag-setup©variable-info/names
  (pointer three©flag-setup©variable-info/names/0))

(define-data three©flag-setup©variable-info/names/0
  (string "false"))

(define-data three©get©variable-info
  (int 3)
  (pointer three©get©variable-info/names))

(define-data three©get©variable-info/names
  (pointer three©get©variable-info/names/0)
  (pointer three©get©variable-info/names/1)
  (pointer three©get©variable-info/names/2))

(define-data three©get©variable-info/names/0
  (string "flag"))

(define-data three©get©variable-info/names/1
  (string "result"))

(define-data three©get©variable-info/names/2
  (string "true"))

(define-data three©init-function©variable-info
  (int 5)
  (pointer three©init-function©variable-info/names))

(define-data three©init-function©variable-info/names
  (pointer three©init-function©variable-info/names/0)
  (pointer three©init-function©variable-info/names/1)
  (pointer three©init-function©variable-info/names/2)
  (pointer three©init-function©variable-info/names/3)
  (pointer three©init-function©variable-info/names/4))

(define-data three©init-function©variable-info/names/0
  (string "_₁"))

(define-data three©init-function©variable-info/names/1
  (string "_₂"))

(define-data three©init-function©variable-info/names/2
  (string "_₃"))

(define-data three©init-function©variable-info/names/3
  (string "_₄"))

(define-data three©init-function©variable-info/names/4
  (string "_↩"))

(define-data _main©variable-info
  (int 3)
  (pointer _main©variable-info/names))

(define-data _main©variable-info/names
  (pointer _main©variable-info/names/0)
  (pointer _main©variable-info/names/1)
  (pointer _main©variable-info/names/2))

(define-data _main©variable-info/names/0 (string "_₁"))

(define-data _main©variable-info/names/1 (string "_₂"))

(define-data _main©variable-info/names/2 (string "_↩"))

(define-data _main©setup©variable-info
  (int 3)
  (pointer _main©setup©variable-info/names))

(define-data _main©setup©variable-info/names
  (pointer _main©setup©variable-info/names/0)
  (pointer _main©setup©variable-info/names/1)
  (pointer _main©setup©variable-info/names/2))

(define-data _main©setup©variable-info/names/0
  (string "address"))

(define-data _main©setup©variable-info/names/1
  (string "metadata"))

(define-data _main©setup©variable-info/names/2
  (string "function"))

(define-data println-non-void©setup©variable-info
  (int 3)
  (pointer println-non-void©setup©variable-info/names))

(define-data println-non-void©setup©variable-info/names
  (pointer println-non-void©setup©variable-info/names/0)
  (pointer println-non-void©setup©variable-info/names/1)
  (pointer println-non-void©setup©variable-info/names/2))

(define-data println-non-void©setup©variable-info/names/0
  (string "address"))

(define-data println-non-void©setup©variable-info/names/1
  (string "metadata"))

(define-data println-non-void©setup©variable-info/names/2
  (string "function"))

(define-data iadd©setup©variable-info
  (int 3)
  (pointer iadd©setup©variable-info/names))

(define-data iadd©setup©variable-info/names
  (pointer iadd©setup©variable-info/names/0)
  (pointer iadd©setup©variable-info/names/1)
  (pointer iadd©setup©variable-info/names/2))

(define-data iadd©setup©variable-info/names/0
  (string "address"))

(define-data iadd©setup©variable-info/names/1
  (string "metadata"))

(define-data iadd©setup©variable-info/names/2
  (string "function"))

(define-data make-function©setup©variable-info
  (int 3)
  (pointer make-function©setup©variable-info/names))

(define-data make-function©setup©variable-info/names
  (pointer make-function©setup©variable-info/names/0)
  (pointer make-function©setup©variable-info/names/1)
  (pointer make-function©setup©variable-info/names/2))

(define-data make-function©setup©variable-info/names/0
  (string "address"))

(define-data make-function©setup©variable-info/names/1
  (string "metadata"))

(define-data make-function©setup©variable-info/names/2
  (string "function"))

(define-data _setup©variable-info
  (int 1)
  (pointer _setup©variable-info/names))

(define-data _setup©variable-info/names
  (pointer _setup©variable-info/names/0))

(define-data _setup©variable-info/names/0 (string "_"))
