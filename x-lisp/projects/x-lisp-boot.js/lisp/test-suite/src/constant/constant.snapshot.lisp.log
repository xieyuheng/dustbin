;;; Input

(define one 1)

(define two (iadd 1 one))

(define three (iadd 1 two))

(define (_main) (println-non-void three))

;;; ShrinkPass

(define one 1)

(define two ((iadd 1) one))

(define three ((iadd 1) two))

(define (_main) (println-non-void three))

;;; UniquifyPass

(define one 1)

(define two ((iadd 1) one))

(define three ((iadd 1) two))

(define (_main) (println-non-void three))

;;; RevealGlobalPass

(define one 1)

(define two
  (((@primitive-function iadd 2) 1) (@constant one)))

(define three
  (((@primitive-function iadd 2) 1) (@constant two)))

(define (_main)
  ((@primitive-function println-non-void 1)
   (@constant three)))

;;; LiftLambdaPass

(define one 1)

(define two
  (((@primitive-function iadd 2) 1) (@constant one)))

(define three
  (((@primitive-function iadd 2) 1) (@constant two)))

(define (_main)
  ((@primitive-function println-non-void 1)
   (@constant three)))

;;; UnnestOperandPass

(define one 1)

(define two
  (@let1 _₁ (@primitive-function iadd 2)
    (@let1 _₂ 1
      (@let1 _₃ (_₁ _₂) (@let1 _₄ (@constant one) (_₃ _₄))))))

(define three
  (@let1 _₁ (@primitive-function iadd 2)
    (@let1 _₂ 1
      (@let1 _₃ (_₁ _₂) (@let1 _₄ (@constant two) (_₃ _₄))))))

(define (_main)
  (@let1 _₁ (@primitive-function println-non-void 1)
    (@let1 _₂ (@constant three) (_₁ _₂))))

